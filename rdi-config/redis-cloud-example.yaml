# Redis RDI Configuration for Redis Cloud
# Example configuration for connecting to Redis Cloud

connections:
  # Redis Cloud target configuration
  target:
    type: redis
    # Replace with your Redis Cloud endpoint (from Redis Cloud dashboard)
    host: redis-12345.c123.us-east-1-2.ec2.redns.redis-cloud.com
    # Replace with your Redis Cloud port
    port: 12345
    # Replace with your Redis Cloud password
    password: your_redis_cloud_password_here
    # Username (usually 'default' for Redis Cloud)
    username: default
    
    # TLS is required for Redis Cloud
    tls: true
    tls_skip_verify: true

  # PostgreSQL source (connects to the container)
  source:
    type: postgresql
    host: postgresql
    port: 5432
    database: musicstore
    user: postgres
    password: postgres
    logical_replication: true

# RDI pipeline configuration
source:
  connection: source
  tables:
    # Sync all tracks
    - name: "Track"
      key_pattern: "track:${TrackId}"
      columns: "*"
    
    # Sync all albums
    - name: "Album"
      key_pattern: "album:${AlbumId}"
      columns: "*"
    
    # Sync all genres
    - name: "Genre"
      key_pattern: "genre:${GenreId}"
      columns: "*"
    
    # Sync CTF flags
    - name: "ctf_flags"
      key_pattern: "flag:${lab_id}"
      columns: "*"

# Data processing settings
applier:
  batch: 100
  duration: 100
  error_handling: dlq
  dlq_max_messages: 100
  target_data_type: hash

# Optional: Add transformations
transforms:
  - name: add_timestamp
    type: add_field
    field: "synced_at"
    value: "${__timestamp}"

# Logging configuration
logging:
  level: info
  console: true
